# 社交网络评测系统

## 系统概述

* 这是一个用于评测OO U3 社交网络模拟程序的自动化评测系统，支持多线程测试、错误检测和详细错误报告生成。系统能够自动生成多样化的测试数据，执行测试用例，并验证程序的正确性。
* 整体评测框架来自于[wxf学长的评测机](https://github.com/zhangyitonggg/BUAA-2024-OO-test/tree/hw9)，由@[UHO](https://github.com/TheUHO)修改符合本单元要求，我主要优化了数据的生成部分，即generator.py

## 主要特点

1. **多模式测试数据生成**：
   - 支持6种不同的测试数据生成策略
   - 包含常规测试、压力测试和特殊场景测试
   - 自动随机选择测试模式

2. **多线程执行**：
   - 可同时测试多个JAR程序
   - 支持单线程和多线程模式切换

3. **全面的错误检测**：
   - 检测运行时错误、超时错误和答案错误
   - 自动记录错误详情

4. **详细的错误报告**：
   - 为每个错误生成包含输入、输出、预期结果和错误信息的完整报告
   - 按时间戳和程序名分类存储错误信息

5. **灵活的配置**：
   - 通过config.json自定义测试参数
   - 支持命令行参数控制程序行为

## 使用方法

### 基本使用

1. 将待测试的JAR文件放在项目根目录下
2. 运行主程序：
   ```
   python main.py
   ```

### 命令行选项

| 选项                   | 描述                       |
| ---------------------- | -------------------------- |
| `-h`, `--help`         | 显示帮助信息               |
| `-m`, `--multiprocess` | 使用多进程模式             |
| `-s`, `--single`       | 使用单进程模式             |
| `-n`, `--nointeract`   | 非交互模式，不显示进度信息 |

### 配置文件 (config.json)

```json
{
    "test_num": 10000,          // 测试用例数量
    "run_time_limit": 30,       // 运行时间限制(秒)
    "command_num_max": 10000,   // 每条测试用例最大指令数
    "error_folder_name": "errors" // 错误输出目录
}
```

## 数据生成策略

系统采用6种不同的数据生成策略，每种策略针对不同的测试场景：

1. **常规测试数据 (normal_data)**
   - 生成基本的社交网络操作指令
   - 包含用户添加、关系建立、标签管理等常规操作

2. **扩展测试数据 (extend_data)**
   - 生成带有重叠标签的测试数据
   - 测试标签系统的边界情况

3. **完全随机测试 (all_random)**
   - 完全随机生成各种指令
   - 测试程序的鲁棒性

4. **压力测试数据 (stress_test_data)**
   - 生成高负载测试场景
   - 包含大量关系修改和复杂查询

5. **结构化社交媒体测试 (structured_social_media_test)**
   - 模拟真实社交媒体场景
   - 分阶段测试：初始化、公众号创建、内容发布、高频操作

6. **特殊查询测试 (special_qtvs/special_qba_stress_test)**
   - 针对特定查询(qtvs, qba)设计的压力测试
   - 模拟实际的高并发情景
   - 测试查询性能的边界情况

## 错误处理

系统会检测并记录以下类型的错误：

1. **运行时错误**：程序崩溃或抛出异常
2. **超时错误**：程序执行超过时间限制
3. **答案错误**：程序输出与预期结果不符
4. **不可达代码**：检测到程序中的不可达代码

每个错误都会生成详细的错误报告，包含：
- 输入指令
- 程序输出
- 预期结果
- 错误信息
- 时间戳

## 输出结构

```
项目根目录/
├── errors/                # 错误报告目录
│   ├── 程序名1/           # 按程序名分类
│   │   ├── 时间戳1/       # 按错误发生时间分类
│   │   │   ├── BUG_INFO.txt  # 错误描述
│   │   │   ├── INPUT.txt     # 输入指令
│   │   │   ├── OUTPUT.txt    # 程序输出
│   │   │   └── ANS.txt       # 预期结果
│   │   └── ...
│   └── ...
├── input/                # 生成的测试用例
│   └── input1.txt        # 测试用例文件
└── matcher.log           # 测试进度日志(非交互模式)
```

## 依赖项

- Python 3.x
- colorama (用于彩色输出)
- 待测试的Java程序(需编译为JAR文件)
